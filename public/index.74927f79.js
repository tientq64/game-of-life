m.mount(document.body,class{constructor(){for(let t of(this.width=screen.width,this.height=screen.height,this.groupA=null,this.groupB=null,this.isShowPanel=!0,this.loaded=!1,Object.getOwnPropertyNames(Object.getPrototypeOf(this))))"function"==typeof this[t]&&(this[t]=this[t].bind(this))}oncreate(t){let e=this.canvasVnode.dom.transferControlToOffscreen();this.worker=new Worker(new URL("worker.js",location.href)),this.worker.addEventListener("message",this.onmessageWorker),this.send("init",{width:this.width,height:this.height,offscreenCanvas:e},[e]),window.addEventListener("keydown",this.onkeydownGlobal),m.redraw()}send(t,e,s){this.worker.postMessage([t,e],s)}sendProps(...t){let e={};for(let s of t)e[s]=this[s];this.worker.postMessage(["props",e])}sendCall(t,...e){this.worker.postMessage(["call",{name:t,args:e}])}getBgColorByG(t){return t>0?`rgba(0, 128, 0, ${t})`:t<0?`rgba(255, 0, 0, ${-t})`:"#0000"}getTextColorByG(t){return t>0?"#84cc16":t<0?"#fb7185":"#fff"}onmousedownGroupA(t,e){let s=e.shiftKey?10:1;switch(e.button){case 0:this.sendCall("addAtoms",t.color,s);break;case 2:this.sendCall("removeAtoms",t.color,s)}}onmouseenterG(t,e){this.groupA=t,this.groupB=e}onmouseleaveG(){this.groupA=null,this.groupB=null}onmousedownG(t,e,s){let o=s.shiftKey?1:.1,n=this.gMaps[t.color],i=n[e.color];switch(s.button){case 0:case 2:2==s.button&&(o*=-1),this.gMaps[t.color][e.color]=Math.round((i+o)*10)/10,this.sendProps("gMaps");break;case 1:this.gMaps[t.color][e.color]=0,this.sendProps("gMaps")}}onmessageWorker(t){let[e,s]=t.data;switch(e){case"loaded":Object.assign(this,s),this.loaded=!0;break;case"props":Object.assign(this,s)}m.redraw()}onkeydownGlobal(t){let{ctrlKey:e,shiftKey:s,altKey:o,repeat:n}=t,i=!e&&!s&&!o&&!n;if("Space"==t.code&&i&&t.target.matches("button, input[type=number]")&&(t.preventDefault(),t.target.blur()),document.activeElement===document.body){switch(t.code){case"Space":i&&(this.isShowPanel=!this.isShowPanel);break;case"KeyR":i&&this.sendCall("randomGMaps")}m.redraw()}}view(){return m(".h-full",this.loaded&&m(".absolute.p-3.w-72.h-full.bg-black.bg-opacity-50",{hidden:!this.isShowPanel},m("p","Lực tương t\xe1c:"),m("table.w-full.table-fixed.text-center",m("tr.h-7",m("th.font-normal","AB"),this.groups.map(t=>m("th",{style:{background:t.color}}))),this.groups.map(t=>m("tr.h-7",m("th.justify-center.items-center.text-xs.font-normal.text-white",{style:{background:t.color},onmousedown:this.onmousedownGroupA.bind(this,t)},t.atomsNum),this.groups.map(e=>{let s=this.gMaps[t.color][e.color];return m("td.justify-center.items-center.text-xs.text-white",{style:{background:this.getBgColorByG(s)},onmouseenter:this.onmouseenterG.bind(this,t,e),onmouseleave:this.onmouseleaveG,onmousedown:this.onmousedownG.bind(this,t,e)},Math.round(10*s))})))),m(".mt-2.h-6",this.groupA&&m(".flex.items-center.gap-4",m(".flex.items-center",m(".w-6.h-6.border",{style:{background:this.groupA.color}}),m(".w-6.h-6.border.border-l-0",{style:{background:this.groupB.color}}),m(".ml-2.w-6.h-6.flex.justify-center.items-center.text-xs",{style:{background:this.getBgColorByG(this.gMaps[this.groupA.color][this.groupB.color])}},Math.round(10*this.gMaps[this.groupA.color][this.groupB.color]))),m(".flex.items-center",m(".w-6.h-6.border",{style:{background:this.groupB.color}}),m(".w-6.h-6.border.border-l-0",{style:{background:this.groupA.color}}),m(".ml-2.w-6.h-6.flex.justify-center.items-center.text-xs",{style:{background:this.getBgColorByG(this.gMaps[this.groupB.color][this.groupA.color])}},Math.round(10*this.gMaps[this.groupB.color][this.groupA.color]))))),m(".mt-2","Khoảng ngẫu nhi\xean khi tạo lực:"),m(".flex.gap-2",m("input.flex-1.min-w-0.px-2.rounded.text-black",{type:"number",max:this.maxRandomG,value:this.minRandomG,title:"Min",oninput:t=>{let e=Number(t.target.value);isNaN(e)||(this.minRandomG=e,this.sendProps("minRandomG"))}}),m("input.flex-1.min-w-0.px-2.rounded.text-black",{type:"number",min:this.minRandomG,value:this.maxRandomG,title:"Max",oninput:t=>{let e=Number(t.target.value);isNaN(e)||(this.maxRandomG=e,this.sendProps("maxRandomG"))}})),m(".mt-2.text-center",m("button.px-2.border.border-gray-400.hover:border-gray-300.rounded.bg-gray-600",{onclick:()=>{this.sendCall("randomGMaps")}},"Ngẫu nhi\xean lực"),m("button.px-2.border.border-gray-400.hover:border-gray-300.rounded.bg-gray-600.ml-2",{onclick:()=>{this.sendCall("resetGMaps")}},"Reset lực")),m(".mt-2","Khoảng c\xe1ch c\xe1c hạt tương t\xe1c:"),m(".flex.gap-2",m("input.flex-1.min-w-0.px-2.rounded.text-black",{type:"number",min:0,max:this.maxDistance,value:this.minDistance,title:"Min",oninput:t=>{let e=Number(t.target.value);isNaN(e)||(this.minDistance=e,this.sendProps("minDistance"))}}),m("input.flex-1.min-w-0.px-2.rounded.text-black",{type:"number",min:this.minDistance,max:1e3,value:this.maxDistance,title:"Max",oninput:t=>{let e=Number(t.target.value);isNaN(e)||(this.maxDistance=e,this.sendProps("maxDistance"))}})),m(".mt-2","B\xe1n k\xednh hạt:"),m("input.flex-1.min-w-0.w-full.px-2.rounded.text-black",{type:"number",min:.5,max:500,step:.5,value:this.radius,oninput:t=>{let e=Number(t.target.value);isNaN(e)||(this.radius=e,this.sendProps("radius"))}}),m(".mt-2","Độ trong suốt hạt:"),m("input.flex-1.min-w-0.w-full.px-2.rounded.text-black",{type:"number",min:.1,max:1,step:.1,value:this.alpha,oninput:t=>{let e=Number(t.target.value);isNaN(e)||(this.alpha=e,this.sendProps("alpha"))}}),m(".mt-2","Hiệu ứng vệt mờ:"),m("input.flex-1.min-w-0.w-full.px-2.rounded.text-black",{type:"number",min:0,max:1,step:.1,value:this.trail,oninput:t=>{let e=Number(t.target.value);isNaN(e)||(this.trail=e,this.sendProps("trail"))}}),m("p.mt-2","Hướng dẫn:"),m("p.text-sm.text-gray-400",m("div","Chuột tr\xe1i: Lực + 1"),m("div","Chuột phải: Lực - 1"),m("div","Chuột giữa: Lực = 0"),m("div","Đ\xe8 Shift để tăng/giảm 10 lần")),m("p.text-sm.text-gray-400",m("div","Cột dọc l\xe0 A, cột ngang l\xe0 B"),m("div","Lực > 0, A đẩy B"),m("div","Lực < 0, A h\xfat B")),m("p.text-sm.text-gray-400",m("div","C\xf3 thể cuộn chuột khi bấm v\xe0o \xf4 input để tăng/giảm."),m("div","Nhấn R để ngẫu nhi\xean lực."),m("div","Nhấn Space để bật/tắt bảng điều khiển n\xe0y."))),this.canvasVnode=m("canvas",{width:this.width,height:this.height}))}}),window.addEventListener("contextmenu",t=>{t.preventDefault()}),document.body.addEventListener("wheel",()=>{});